
Project level Secrets


KEYSTORE_PASSWORD - HNGFFDGDSFDSGDSGVBN

KEY_PASSWORD - HNGFFDGDSFDSGDSGVBN

KEY_ALIAS - aliasFDHFDH


--------------

bundleRelease

--------------



#!/bin/bash
set -e

# –ü—É—Ç—å –¥–ª—è keystore
KEYSTORE_PATH="$BITRISE_SOURCE_DIR/my-release-key.jks"

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ—Ä—ë–º –∏–∑ Secrets Bitrise
KEYSTORE_PASSWORD="${KEYSTORE_PASSWORD:?–ù–µ –∑–∞–¥–∞–Ω —Å–µ–∫—Ä–µ—Ç KEYSTORE_PASSWORD}"
KEY_PASSWORD="${KEY_PASSWORD:?–ù–µ –∑–∞–¥–∞–Ω —Å–µ–∫—Ä–µ—Ç KEY_PASSWORD}"
KEY_ALIAS="${KEY_ALIAS:?–ù–µ –∑–∞–¥–∞–Ω —Å–µ–∫—Ä–µ—Ç KEY_ALIAS}"
DNAME="${DNAME:-CN=Bitrise, OU=CI, O=MyCompany, L=City, S=Region, C=US}"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ keystore
if [ -f "$KEYSTORE_PATH" ]; then
  echo "‚úÖ Keystore —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $KEYSTORE_PATH"
else
  echo "‚öôÔ∏è Keystore –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π..."
  keytool -genkeypair -v \
    -keystore "$KEYSTORE_PATH" \
    -storepass "$KEYSTORE_PASSWORD" \
    -keypass "$KEY_PASSWORD" \
    -keyalg RSA -keysize 2048 -validity 10000 \
    -alias "$KEY_ALIAS" \
    -dname "$DNAME"
  echo "‚úÖ Keystore —Å–æ–∑–¥–∞–Ω: $KEYSTORE_PATH"
fi

# –ö–æ–ø–∏—Ä—É–µ–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é deploy –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
mkdir -p "$BITRISE_DEPLOY_DIR"
cp "$KEYSTORE_PATH" "$BITRISE_DEPLOY_DIR/"

echo "üì¶ Keystore –≥–æ—Ç–æ–≤ –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç"


